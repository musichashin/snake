<!DOCTYPE html>
<html>
<head>
  <title>Neon Bounce</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    body {
      margin: 0;
      background: #111;
      overflow: hidden;
      font-family: 'Courier New', sans-serif;
      touch-action: none;
      user-select: none;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    #ui-layer {
      position: absolute;
      top: 20px;
      left: 20px;
      color: #0ff;
      font-size: 20px;
      font-weight: bold;
      text-shadow: 0 0 5px #0ff;
      pointer-events: none;
    }
    #controls {
      position: absolute;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 20px;
      box-sizing: border-box;
      pointer-events: none;
    }
    .btn {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid #fff;
      border-radius: 50%;
      color: white;
      font-size: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: auto;
      backdrop-filter: blur(5px);
    }
    .btn:active { background: rgba(255, 255, 255, 0.4); }
    .right-controls { display: flex; }
    .left-controls { display: flex; gap: 15px; }
  </style>
</head>
<body>

<div id="ui-layer">LEVEL: <span id="levelDisplay">1</span></div>
<canvas id="gameCanvas"></canvas>

<div id="controls">
  <div class="left-controls">
    <div class="btn" id="btnLeft">‚Üê</div>
    <div class="btn" id="btnRight">‚Üí</div>
  </div>
  <div class="right-controls">
    <div class="btn" id="btnJump">ü¶ò</div>
  </div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const levelDisplay = document.getElementById('levelDisplay');

// --- –ù–ê–°–¢–†–û–ô–ö–ò –§–ò–ó–ò–ö–ò ---
let width, height;
const gravity = 0.5;
const friction = 0.8; 
const jumpForce = -12; // –ß—É—Ç—å –≤—ã—à–µ –ø—Ä—ã–∂–æ–∫
const moveSpeed = 6;

// --- –£–†–û–í–ù–ò ---
// type: 'block' (–æ–±—ã—á–Ω—ã–π –ø–æ–ª) –∏–ª–∏ 'win' (—Ñ–∏–Ω–∏—à —É—Ä–æ–≤–Ω—è, –∑–µ–ª–µ–Ω—ã–π)
const levels = [
  // –£–†–û–í–ï–ù–¨ 1: –†–∞–∑–º–∏–Ω–∫–∞ (–¥–ª–∏–Ω–Ω—ã–π)
  [
    {x: 0, y: 300, w: 1000, h: 50, type: 'block'}, // –°—Ç–∞—Ä—Ç
    {x: 400, y: 200, w: 100, h: 20, type: 'block'},
    {x: 600, y: 150, w: 100, h: 20, type: 'block'},
    {x: 1100, y: 250, w: 400, h: 50, type: 'block'},
    {x: 1600, y: 300, w: 500, h: 50, type: 'block'}, // –î–ª–∏–Ω–Ω—ã–π –ø—Ä–æ–±–µ–≥
    {x: 2000, y: 200, w: 50, h: 100, type: 'win'}    // –§–ò–ù–ò–®
  ],
  
  // –£–†–û–í–ï–ù–¨ 2: –û—Å—Ç—Ä–æ–≤–∞ (–Ω—É–∂–Ω–æ –ø—Ä—ã–≥–∞—Ç—å —Ç–æ—á–Ω–æ)
  [
    {x: 0, y: 300, w: 200, h: 50, type: 'block'},
    {x: 300, y: 300, w: 100, h: 20, type: 'block'},
    {x: 500, y: 250, w: 80, h: 20, type: 'block'},
    {x: 700, y: 200, w: 80, h: 20, type: 'block'},
    {x: 900, y: 150, w: 80, h: 20, type: 'block'},
    {x: 1100, y: 300, w: 200, h: 50, type: 'block'},
    {x: 1400, y: 200, w: 50, h: 20, type: 'block'},
    {x: 1600, y: 250, w: 50, h: 100, type: 'win'} // –§–ò–ù–ò–®
  ],

  // –£–†–û–í–ï–ù–¨ 3: –ë–æ–ª—å—à–∞—è —Å—Ç–µ–Ω–∞
  [
    {x: 0, y: 350, w: 300, h: 50, type: 'block'},
    {x: 300, y: 250, w: 50, h: 20, type: 'block'}, // –°—Ç—É–ø–µ–Ω—å–∫–∞ 1
    {x: 400, y: 150, w: 50, h: 20, type: 'block'}, // –°—Ç—É–ø–µ–Ω—å–∫–∞ 2
    {x: 500, y: 50, w: 50, h: 20, type: 'block'},  // –°—Ç—É–ø–µ–Ω—å–∫–∞ 3 (–≤—ã—Å–æ–∫–æ)
    {x: 700, y: 350, w: 1000, h: 50, type: 'block'}, // –ü–æ–ª –≤–Ω–∏–∑—É
    {x: 1000, y: 250, w: 50, h: 100, type: 'block'}, // –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ
    {x: 1200, y: 150, w: 50, h: 20, type: 'block'},
    {x: 1500, y: 300, w: 50, h: 50, type: 'win'} // –§–ò–ù–ò–®
  ]
];

// --- –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´ ---
let currentLevelIndex = 0;
let currentLevelData = [];
const player = { x: 50, y: 100, radius: 15, dx: 0, dy: 0, grounded: false };
const keys = { left: false, right: false, jump: false };

function loadLevel(index) {
  if (index >= levels.length) index = 0; // –ï—Å–ª–∏ —É—Ä–æ–≤–Ω–∏ –∫–æ–Ω—á–∏–ª–∏—Å—å, –Ω–∞—á–∏–Ω–∞–µ–º —Å–Ω–∞—á–∞–ª–∞
  currentLevelIndex = index;
  currentLevelData = levels[currentLevelIndex];
  
  // –°–±—Ä–æ—Å –∏–≥—Ä–æ–∫–∞
  player.x = 50;
  player.y = 0; // –ü–∞–¥–∞–µ–º —Å–≤–µ—Ä—Ö—É
  player.dx = 0;
  player.dy = 0;
  
  levelDisplay.innerText = currentLevelIndex + 1;
}

function resize() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
}
window.addEventListener('resize', resize);
resize();
loadLevel(0); // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å

// --- –§–ò–ó–ò–ö–ê ---
function update() {
  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  if (keys.right) if (player.dx < moveSpeed) player.dx++;
  if (keys.left) if (player.dx > -moveSpeed) player.dx--;
  
  player.dx *= friction;
  player.dy += gravity;

  if (keys.jump && player.grounded) {
    player.dy = jumpForce;
    player.grounded = false;
  }

  player.x += player.dx;
  player.y += player.dy;
  player.grounded = false;

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
  currentLevelData.forEach(block => {
    // –ü–æ–ø–∞–¥–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª—ã –±–ª–æ–∫–∞ –ø–æ X
    if (player.x > block.x - player.radius && player.x < block.x + block.w + player.radius) {
      
      // –°–≤–µ—Ä—Ö—É –Ω–∞ –±–ª–æ–∫
      if (player.y + player.radius > block.y && 
          player.y + player.radius < block.y + block.h + 10 && 
          player.dy >= 0) {
            
        // –ï—Å–ª–∏ —ç—Ç–æ –§–ò–ù–ò–®
        if (block.type === 'win') {
            loadLevel(currentLevelIndex + 1);
            return;
        }

        player.y = block.y - player.radius;
        player.dy = -player.dy * 0.4;
        if(Math.abs(player.dy) < 1) player.dy = 0;
        player.grounded = true;
      }
    }
  });

  // –£–ø–∞–ª –≤ –ø—Ä–æ–ø–∞—Å—Ç—å
  if (player.y > height + 200) {
    loadLevel(currentLevelIndex); // –†–µ—Å—Ç–∞—Ä—Ç —É—Ä–æ–≤–Ω—è
  }
}

// --- –û–¢–†–ò–°–û–í–ö–ê ---
function draw() {
  ctx.clearRect(0, 0, width, height);

  // –ö–∞–º–µ—Ä–∞
  let cameraX = player.x - width / 3;
  if (cameraX < 0) cameraX = 0;

  ctx.save();
  ctx.translate(-cameraX, 0);

  // –†–∏—Å—É–µ–º –±–ª–æ–∫–∏
  currentLevelData.forEach(block => {
    if (block.type === 'win') {
        // –ó–µ–ª–µ–Ω—ã–π –ø–æ—Ä—Ç–∞–ª
        ctx.fillStyle = '#0f0';
        ctx.shadowColor = '#0f0';
    } else {
        // –û–±—ã—á–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
        ctx.fillStyle = '#0ff';
        ctx.shadowColor = '#0ff';
    }
    ctx.shadowBlur = 15;
    ctx.fillRect(block.x, block.y, block.w, block.h);
  });
  
  ctx.shadowBlur = 0;

  // –ò–≥—Ä–æ–∫
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
  ctx.fillStyle = '#ff0044';
  ctx.fill();
  
  // –ë–ª–∏–∫
  ctx.beginPath();
  ctx.arc(player.x - 5, player.y - 5, 5, 0, Math.PI * 2);
  ctx.fillStyle = 'rgba(255,255,255,0.5)';
  ctx.fill();
  
  ctx.restore();
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

// --- –ö–ù–û–ü–ö–ò ---
const btnLeft = document.getElementById('btnLeft');
const btnRight = document.getElementById('btnRight');
const btnJump = document.getElementById('btnJump');

function bindTouch(btn, code) {
  btn.addEventListener('touchstart', (e) => { e.preventDefault(); keys[code] = true; });
  btn.addEventListener('touchend', (e) => { e.preventDefault(); keys[code] = false; });
  btn.addEventListener('mousedown', (e) => { e.preventDefault(); keys[code] = true; });
  btn.addEventListener('mouseup', (e) => { e.preventDefault(); keys[code] = false; });
}
bindTouch(btnLeft, 'left');
bindTouch(btnRight, 'right');
bindTouch(btnJump, 'jump');

document.addEventListener('keydown', (e) => {
  if (e.code === 'ArrowLeft') keys.left = true;
  if (e.code === 'ArrowRight') keys.right = true;
  if (e.code === 'Space' || e.code === 'ArrowUp') keys.jump = true;
});
document.addEventListener('keyup', (e) => {
  if (e.code === 'ArrowLeft') keys.left = false;
  if (e.code === 'ArrowRight') keys.right = false;
  if (e.code === 'Space' || e.code === 'ArrowUp') keys.jump = false;
});

loop();
</script>
</body>
</html>

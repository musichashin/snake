<!DOCTYPE html>
<html>
<head>
  <title>Neon Bounce HARDCORE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    body {
      margin: 0;
      background: #050505; /* –ü–æ—á—Ç–∏ —á–µ—Ä–Ω—ã–π */
      overflow: hidden;
      font-family: 'Courier New', sans-serif;
      touch-action: none;
      user-select: none;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    #ui-layer {
      position: absolute;
      top: 20px;
      left: 20px;
      color: #ff0044;
      font-size: 24px;
      font-weight: bold;
      text-shadow: 0 0 10px #f00;
      pointer-events: none;
    }
    #controls {
      position: absolute;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 20px;
      box-sizing: border-box;
      pointer-events: none;
    }
    .btn {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid #555;
      border-radius: 50%;
      color: white;
      font-size: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: auto;
      backdrop-filter: blur(5px);
    }
    .btn:active { background: rgba(255, 0, 68, 0.4); border-color: #f04; }
    .right-controls { display: flex; }
    .left-controls { display: flex; gap: 15px; }
  </style>
</head>
<body>

<div id="ui-layer">DEATH ZONE: LVL <span id="levelDisplay">1</span></div>
<canvas id="gameCanvas"></canvas>

<div id="controls">
  <div class="left-controls">
    <div class="btn" id="btnLeft">‚Üê</div>
    <div class="btn" id="btnRight">‚Üí</div>
  </div>
  <div class="right-controls">
    <div class="btn" id="btnJump">ü¶ò</div>
  </div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const levelDisplay = document.getElementById('levelDisplay');

// --- –§–ò–ó–ò–ö–ê (TWEAKED FOR HARDCORE) ---
let width, height;
const gravity = 0.6; // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è —á—É—Ç—å —Å–∏–ª—å–Ω–µ–µ (—Ç—è–∂–µ–ª–µ–µ –ø—Ä—ã–≥–∞—Ç—å)
const friction = 0.85; 
const jumpForce = -13; 
const moveSpeed = 6;

// --- –£–†–û–í–ù–ò ---
// type: 'block' (—Å–∏–Ω–∏–π –ø–æ–ª), 'win' (–∑–µ–ª–µ–Ω—ã–π —Ñ–∏–Ω–∏—à), 'danger' (–∫—Ä–∞—Å–Ω–∞—è –ª–∞–≤–∞)
const levels = [
  // –£–†–û–í–ï–ù–¨ 1: –ü–æ–ª —ç—Ç–æ –ª–∞–≤–∞ (–ü—Ä—ã–∂–∫–∏ –≤–µ—Ä—ã)
  [
    {x: 0, y: 300, w: 200, h: 50, type: 'block'}, // –°—Ç–∞—Ä—Ç
    {x: 0, y: 400, w: 3000, h: 50, type: 'danger'}, // –õ–ê–í–ê –í–ù–ò–ó–£
    
    {x: 300, y: 250, w: 80, h: 20, type: 'block'},
    {x: 550, y: 200, w: 80, h: 20, type: 'block'}, // –î–∞–ª–µ–∫–∏–π –ø—Ä—ã–∂–æ–∫
    {x: 800, y: 150, w: 80, h: 20, type: 'block'},
    {x: 1100, y: 250, w: 80, h: 20, type: 'block'}, // –ü—Ä—ã–∂–æ–∫ –≤–Ω–∏–∑
    {x: 1350, y: 300, w: 80, h: 20, type: 'block'}, 
    {x: 1600, y: 200, w: 50, h: 20, type: 'block'}, // –ú–∞–ª–µ–Ω—å–∫–∞—è –æ–ø–æ—Ä–∞
    {x: 1800, y: 250, w: 50, h: 100, type: 'win'}   // –§–ò–ù–ò–®
  ],
  
  // –£–†–û–í–ï–ù–¨ 2: –¢–æ–Ω–Ω–µ–ª—å —Å–º–µ—Ä—Ç–∏ (–£–∑–∫–æ)
  [
    {x: 0, y: 300, w: 200, h: 50, type: 'block'},
    {x: 200, y: 350, w: 2000, h: 50, type: 'danger'}, // –ü–æ–ª –ª–∞–≤–∞
    {x: 300, y: 0, w: 2000, h: 100, type: 'danger'},  // –ü–æ—Ç–æ–ª–æ–∫ –ª–∞–≤–∞ (–Ω–µ –ø—Ä—ã–≥–∞–π –≤—ã—Å–æ–∫–æ!)

    {x: 300, y: 250, w: 100, h: 20, type: 'block'},
    {x: 500, y: 250, w: 50, h: 20, type: 'block'},
    {x: 650, y: 200, w: 50, h: 20, type: 'block'}, // –ù—É–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Å–æ—Ç—É –ø—Ä—ã–∂–∫–∞
    {x: 800, y: 250, w: 50, h: 20, type: 'block'},
    {x: 1000, y: 200, w: 50, h: 20, type: 'block'},
    {x: 1200, y: 250, w: 50, h: 20, type: 'block'},
    
    {x: 1400, y: 150, w: 200, h: 20, type: 'block'}, // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞
    {x: 1700, y: 250, w: 50, h: 100, type: 'win'}
  ],

  // –£–†–û–í–ï–ù–¨ 3: –í–µ—Ä—Ç–∏–∫–∞–ª—å (The Tower)
  [
    {x: 0, y: 500, w: 300, h: 50, type: 'block'},
    {x: 300, y: 500, w: 1000, h: 50, type: 'danger'}, // –õ–∞–≤–∞

    {x: 350, y: 400, w: 60, h: 20, type: 'block'}, // 1
    {x: 500, y: 300, w: 60, h: 20, type: 'block'}, // 2
    {x: 350, y: 200, w: 60, h: 20, type: 'block'}, // 3 (–ó–∏–≥–∑–∞–≥ –≤–≤–µ—Ä—Ö)
    {x: 500, y: 100, w: 60, h: 20, type: 'block'}, // 4 (–í—ã—Å–æ–∫–æ)
    
    {x: 700, y: 200, w: 60, h: 20, type: 'block'}, // –°–ø—É—Å–∫
    {x: 900, y: 300, w: 60, h: 20, type: 'block'},
    {x: 1100, y: 400, w: 60, h: 20, type: 'block'},
    
    {x: 1300, y: 350, w: 20, h: 150, type: 'danger'}, // –°—Ç–µ–Ω–∞ —à–∏–ø–æ–≤
    {x: 1350, y: 250, w: 100, h: 20, type: 'block'}, // –ü–µ—Ä–µ–ø—Ä—ã–≥–Ω–∏ —Å—Ç–µ–Ω—É
    
    {x: 1600, y: 400, w: 50, h: 50, type: 'win'}
  ]
];

// --- –°–û–°–¢–û–Ø–ù–ò–ï ---
let currentLevelIndex = 0;
let currentLevelData = [];
const player = { x: 50, y: 100, radius: 15, dx: 0, dy: 0, grounded: false };
const keys = { left: false, right: false, jump: false };

function loadLevel(index) {
  if (index >= levels.length) index = 0;
  currentLevelIndex = index;
  currentLevelData = levels[currentLevelIndex];
  
  player.x = 50;
  player.y = 0;
  player.dx = 0;
  player.dy = 0;
  levelDisplay.innerText = currentLevelIndex + 1;
}

function resize() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
}
window.addEventListener('resize', resize);
resize();
loadLevel(0);

// --- –§–ò–ó–ò–ö–ê ---
function update() {
  if (keys.right) if (player.dx < moveSpeed) player.dx++;
  if (keys.left) if (player.dx > -moveSpeed) player.dx--;
  
  player.dx *= friction;
  player.dy += gravity;

  if (keys.jump && player.grounded) {
    player.dy = jumpForce;
    player.grounded = false;
  }

  player.x += player.dx;
  player.y += player.dy;
  player.grounded = false;

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
  currentLevelData.forEach(block => {
    // AABB –∫–æ–ª–ª–∏–∑–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
    if (player.x > block.x - player.radius && player.x < block.x + block.w + player.radius &&
        player.y > block.y - player.radius && player.y < block.y + block.h + player.radius) {
            
      // –ï—Å–ª–∏ –∫–æ—Å–Ω—É–ª–∏—Å—å –°–ú–ï–†–¢–ï–õ–¨–ù–û–ì–û –±–ª–æ–∫–∞
      if (block.type === 'danger') {
          loadLevel(currentLevelIndex); // –†–µ—Å—Ç–∞—Ä—Ç —É—Ä–æ–≤–Ω—è
          return;
      }
      
      // –ï—Å–ª–∏ –∫–æ—Å–Ω—É–ª–∏—Å—å –§–ò–ù–ò–®–ê
      if (block.type === 'win') {
          loadLevel(currentLevelIndex + 1);
          return;
      }

      // –û–±—ã—á–Ω—ã–π –±–ª–æ–∫ (—Ñ–∏–∑–∏–∫–∞ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è)
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à–ª–∏ (—Å–≤–µ—Ä—Ö—É –∏–ª–∏ —Å–±–æ–∫—É)
      
      // –ü–∞–¥–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É
      if (player.dy > 0 && player.y < block.y) {
         player.y = block.y - player.radius;
         player.dy = -player.dy * 0.3; // –ú–µ–Ω—å—à–µ –æ—Ç—Å–∫–æ–∫
         if(Math.abs(player.dy) < 1) player.dy = 0;
         player.grounded = true;
      }
      // –£–¥–∞—Ä –≥–æ–ª–æ–≤–æ–π —Å–Ω–∏–∑—É
      else if (player.dy < 0 && player.y > block.y + block.h) {
          player.y = block.y + block.h + player.radius;
          player.dy = 0;
      }
    }
  });

  // –£–ø–∞–ª –≤ —Å–∞–º—ã–π –Ω–∏–∑ (–∑–∞ –ø—Ä–µ–¥–µ–ª—ã —ç–∫—Ä–∞–Ω–∞)
  if (player.y > height + 200) {
    loadLevel(currentLevelIndex);
  }
}

// --- –û–¢–†–ò–°–û–í–ö–ê ---
function draw() {
  ctx.clearRect(0, 0, width, height);

  // –ö–∞–º–µ—Ä–∞ —Å–ª–µ–¥–∏—Ç –∑–∞ –∏–≥—Ä–æ–∫–æ–º
  let cameraX = player.x - width / 3;
  if (cameraX < 0) cameraX = 0;

  ctx.save();
  ctx.translate(-cameraX, 0);

  // –†–∏—Å—É–µ–º –±–ª–æ–∫–∏
  currentLevelData.forEach(block => {
    if (block.type === 'win') {
        ctx.fillStyle = '#0f0'; // –ó–µ–ª–µ–Ω—ã–π
        ctx.shadowColor = '#0f0';
        ctx.shadowBlur = 15;
    } else if (block.type === 'danger') {
        ctx.fillStyle = '#f00'; // –ö—Ä–∞—Å–Ω—ã–π (–°–ú–ï–†–¢–¨)
        ctx.shadowColor = '#f00';
        ctx.shadowBlur = 20;
    } else {
        ctx.fillStyle = '#444'; // –°–µ—Ä—ã–π (–ë–µ–∑–æ–ø–∞—Å–Ω–æ)
        ctx.shadowColor = '#fff';
        ctx.shadowBlur = 0;
        ctx.strokeStyle = '#0ff';
        ctx.lineWidth = 2;
        ctx.strokeRect(block.x, block.y, block.w, block.h);
    }
    
    // –ù–µ —Ä–∏—Å—É–µ–º –æ–±–≤–æ–¥–∫—É –¥–ª—è –ª–∞–≤—ã, —á—Ç–æ–±—ã –≤—ã–≥–ª—è–¥–µ–ª–æ –∫–∞–∫ –º–∞—Å—Å–∏–≤
    if (block.type !== 'block') {
        ctx.fillRect(block.x, block.y, block.w, block.h);
    } else {
        // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –±–ª–æ–∫–æ–≤ - –∑–∞–ª–∏–≤–∫–∞ –ø–æ–ø—Ä–æ—â–µ
        ctx.fillRect(block.x, block.y, block.w, block.h);
    }
  });

  // –ò–≥—Ä–æ–∫
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
  ctx.fillStyle = '#fff'; // –ë–µ–ª—ã–π —à–∞—Ä (–∫–æ–Ω—Ç—Ä–∞—Å—Ç —Å —Ç–µ–º–Ω—ã–º —Ñ–æ–Ω–æ–º)
  ctx.shadowColor = '#fff';
  ctx.shadowBlur = 10;
  ctx.fill();
  ctx.closePath();
  
  ctx.restore();
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

// --- –£–ü–†–ê–í–õ–ï–ù–ò–ï ---
const btnLeft = document.getElementById('btnLeft');
const btnRight = document.getElementById('btnRight');
const btnJump = document.getElementById('btnJump');

function bindTouch(btn, code) {
  btn.addEventListener('touchstart', (e) => { e.preventDefault(); keys[code] = true; });
  btn.addEventListener('touchend', (e) => { e.preventDefault(); keys[code] = false; });
  btn.addEventListener('mousedown', (e) => { e.preventDefault(); keys[code] = true; });
  btn.addEventListener('mouseup', (e) => { e.preventDefault(); keys[code] = false; });
}
bindTouch(btnLeft, 'left');
bindTouch(btnRight, 'right');
bindTouch(btnJump, 'jump');

document.addEventListener('keydown', (e) => {
  if (e.code === 'ArrowLeft') keys.left = true;
  if (e.code === 'ArrowRight') keys.right = true;
  if (e.code === 'Space' || e.code === 'ArrowUp') keys.jump = true;
});
document.addEventListener('keyup', (e) => {
  if (e.code === 'ArrowLeft') keys.left = false;
  if (e.code === 'ArrowRight') keys.right = false;
  if (e.code === 'Space' || e.code === 'ArrowUp') keys.jump = false;
});

loop();
</script>
</body>
</html>
